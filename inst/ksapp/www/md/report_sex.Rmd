---
title: "Subadult Sex Estimation Report"
---

```{r setup, echo=FALSE, message=FALSE}
library(pander)
library(caret)
library(dplyr)
```

```{r echo=FALSE, message=FALSE}
r_fdl <- if (!is.na(input$fdl)) paste(input$fdl) else paste("")
r_fmsb <- if (!is.na(input$fmsb)) paste(input$fmsb) else paste("")
r_fdb <- if (!is.na(input$fdb)) paste(input$fdb) else paste("")
r_tdl <- if (!is.na(input$tdl)) paste(input$tdl) else paste("")
r_tpb <- if (!is.na(input$tpb)) paste(input$tpb) else paste("")
r_tmsb <- if (!is.na(input$tmsb)) paste(input$tmsb) else paste("")
r_tdb <- if (!is.na(input$tdb)) paste(input$tdb) else paste("")
r_hdl <- if (!is.na(input$hdl)) paste(input$hdl) else paste("")
r_hpb <- if (!is.na(input$hpb)) paste(input$hpb) else paste("")
r_hmsb <- if (!is.na(input$hmsb)) paste(input$hmsb) else paste("")
r_hdb <- if (!is.na(input$hdb)) paste(input$hdb) else paste("")
r_rdl <- if (!is.na(input$rdl)) paste(input$rdl) else paste("")
r_rpb <- if (!is.na(input$rpb)) paste(input$rpb) else paste("")
r_rmsb <- if (!is.na(input$rmsb)) paste(input$rmsb) else paste("")
r_rdb <- if (!is.na(input$rdb)) paste(input$rdb) else paste("")
r_udl <- if (!is.na(input$udl)) paste(input$udl) else paste("")
r_umsb <- if (!is.na(input$umsb)) paste(input$umsb) else paste("")
```

Generated by KidStats on `r Sys.Date()`

Kyra Stull (2015). kidstats: Subadult age and sex estimations based on long bone measurements. R package version 0.0.1.9003. https://github.com/geanes/kidstats

----

## Input

- Reference sample: **`r switch(input$refsamp, 'za' = 'South Africa')`**

<br>

#### Input measurements

|           | Diaphyseal Length | Proximal Breadth | Midshaft Breadth | Distal Breadth |
| :-------- | :---------------: | :--------------: | :--------------: | :------------: |
|   Femur   |     `r r_fdl`     |                  |    `r r_fmsb`    |    `r r_fdb`   |
|   Tibia   |     `r r_tdl`     |    `r r_tpb`     |    `r r_tmsb`    |    `r r_tdb`   |
|   Humerus |     `r r_hdl`     |    `r r_hpb`     |    `r r_hmsb`    |    `r r_hdb`   |
|   Radius  |     `r r_rdl`     |    `r r_rpb`     |    `r r_rmsb`    |    `r r_rdb`   |
|   Ulna    |     `r r_udl`     |                  |    `r r_umsb`    |                |

<br>

----

## Sex Estimation

|            Posterior Female             |              Posterior Male             |
| :-------------------------------------: | :-------------------------------------: |
| `r round(fda_mod()[[2]]$F, digits = 4)` | `r round(fda_mod()[[2]]$M, digits = 4)` |

<br>

### Model

- Sample size used to model: **`r nrow(sex_samp())`**
- Classification Accuracy: **`r if (input$bstrap_ca) paste(round(fda_mod()[[3]]$t0, digits = 4)," (bootstrapped)") else round(fda_mod()[[3]], digits = 4)`**
- Excluded measurements: `r if (length(input$ex_sex) == 0) pander("none") else pander(input$ex_sex)`

<br>

```{r echo=FALSE, message=FALSE}
fda_coef <- data.frame(coef(fda_mod()[[1]]))
names(fda_coef)[1] <- "Value"
pander(fda_coef)
```

<br>

#### Confusion Matrix

```{r echo=FALSE, message=FALSE}
fda_cm <- data.frame(fda_mod()[[5]])
pander(fda_cm)
```

<br>

#### Correct Classification

Female: **`r paste0(round(fda_mod()[[6]][1] * 100, digits = 2), "%")`** <br>
Male: **`r paste0(round(fda_mod()[[6]][2] * 100, digits = 2), "%")`**
